<!DOCTYPE html>
<html>
    <head>
        <title>WRectangle Building Example</title>
        <style type="text/css">
			html {
				height: 100%;
			}
            body {
                font-family: "Courier New", sans-serif;
                text-align: center;
				height: 100%;
			}
            .value {
                min-width: 2em;
            }
            .state {
                font-size: 2em;
            }
        </style>
    </head>
    <body>
    
    
		<div id="background" style="width:full; height:100%; border:2px; solid black; z-index:-99">
			<div id="square" style="width:200px; height:200px; border:2px solid black; background:red; position:absolute; top:0px; left:0px;"></div>
			<div id="circle" style="width:50px; height:50px; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:200px; left:0px;"></div>
	<!--		<div id='vertline' style="width:2px; height:100%; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:0px; left:300px;"></div>
			<div id='vertline' style="width:2px; height:100%; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:0px; left:600px;"></div>
			<div id='vertline' style="width:2px; height:100%; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:0px; left:900px;"></div>
			<div id='vertline' style="width:2px; height:100%; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:0px; left:1200px;"></div>
       		<div id='vertline' style="width:100%; height:2px; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:200px; left:0px;"></div>
			<div id='vertline' style="width:100%; height:2px; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:400px; left:0px;"></div>
			<div id='vertline' style="width:100%; height:2px; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:600px; left:0px;"></div>
			<div id='vertline' style="width:100%; height:2px; border:2px solid black; background:yellow; border-radius:100px; position:absolute; top:800px; left:0px;"></div>
            <div id='header1' style="width:200px; height:200px;  border-radius:100px; position:absolute; top:50px; left:50px;">
            <h1>Sprint Backlog
            <div id="line" style="width:1px; height:1px; border:1px solid black; background:black; position:absolute; top:1px; left:1px;"></div>
            </div>
            
            <div id='header1' style="width:200px; height:200px;  border-radius:100px; position:absolute; top:50px; left:350px;">
            <h1>Full-kit</h1>
            </div>
            
            <div id='header1' style="width:200px; height:200px;  border-radius:100px; position:absolute; top:50px; left:650px;">
            <h1>In Progress</h1>
            </div>
            
            <div id='header1' style="width:200px; height:200px;  border-radius:100px; position:absolute; top:50px; left:950px;">
            <h1>On Hold</h1>
            </div>
            
            <div id='header1' style="width:200px; height:200px;  border-radius:100px; position:absolute; top:50px; left:1250px;">
            <h1>Done</h1>
            </div> 
            -->
            
            
			
			<div class="state"><span class="users" style="background:red;">Cannot Find Server</span></div>
			
		</div>
    		<canvas id="DemoCanvas" width="1600" height="1000" color="blue"></canvas>  
              
            
            
            
		
		
		
		
		
        <script>
            var users = document.querySelector('.users');
			var square = document.getElementById('square');
			var circle = document.getElementById('circle');
			var line = document.getElementById('line');
			var background = document.getElementById('background');
			var canvas = document.getElementById('DemoCanvas');
			var context = canvas.getContext('2d');
			context.fillStyle = "blue";
            context.fillRect(0, 0, canvas.width, canvas.height);
			//Create the websocket, note the IP and port number are both needed
            var websocket = new WebSocket("ws://127.0.0.1:6789/");
			
			//Left-click event handler
			//background.onclick = function (event) {
    		//	websocket.send(JSON.stringify({action: 'square', XPosition: event.clientX, YPosition: event.clientY}));
			//}
			
			//Left-click event handler (down)
			background.onmousedown = function (event) {
				websocket.send(JSON.stringify({action: 'line_down', X1Position: event.clientX, Y1Position: event.clientY}));
			}
			
			//Left-click event handler (up)
			background.onmouseup = function (event) {
				websocket.send(JSON.stringify({action: 'line_up', X2Position: event.clientX, Y2Position: event.clientY}));
			}
			
			
			//Right-click event handler, this one is more complex because
			//we also prevent the right-click context menu from popping up
			background.addEventListener('contextmenu', function(event){
				event.preventDefault();
				websocket.send(JSON.stringify({action: 'circle', XPosition: event.clientX, YPosition: event.clientY}));
				return false;
			}, false);

			//The websocket message handler, this code executes whenever we get
			// a message from the server.
            websocket.onmessage = function (event) {
                data = JSON.parse(event.data);
				console.log(event.data);
                switch (data.type) {
                    case 'square':
						square.style.left = data.XPosition + "px";
						square.style.top = data.YPosition + "px";
                        break;
                    case 'circle':
                        circle.style.left = data.XPosition + "px";
						circle.style.top = data.YPosition + "px";
                        break;						
                        
                        
                    case 'line':
                        //line.style.left=Math.min(data.X1Position,data.X2Postion)+ "px";
                        //line.style.top=Math.min(data.Y1Position,data.Y2Position)+ "px";
                        //line.style.height=Math.abs(data.Y2Position-data.Y1Position)+"px";
                        //line.style.width=Math.abs(data.X2Position-data.X1Position)+"px";
                        //Always check for properties and methods, to make sure your code doesn't break in other browsers.
                        if (canvas.getContext) 
                         {
                          
                          // Reset the current path
                          context.beginPath(); 
                          // Staring point (data.X1Postion,data.Y1Position)
                           context.moveTo(data.X1Postion,data.Y1Position);
                          // End point (data.X2Position,data.Y2Position)
                          context.lineTo(data.X2Position,data.Y2Position);
                          // Make the line visible
                          context.stroke();
                           }
                        break;
                        
                    case 'users':
						users.style.background = "white";
                        users.textContent = (
                            data.count.toString() + " user" +
                            (data.count == 1 ? "" : "s online"));
                        break;
                    default:
                        console.error(
                            "unsupported event", data);
                }
			};
				
			//This function executes when the websocket transitions to the CLOSED
			//event. Normally this only happens when the server process terminates.
			websocket.onclose = function (event ){
				users.textContent = "Server Disconnected";
				users.style.background = "red";
			};

        </script>
    </body>
</html>